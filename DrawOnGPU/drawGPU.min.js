var b=document.querySelector("canvas"),d=b.getContext("webgl2"),l=new Image;l.src="data:image/png;base64,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";
function n(a,c){this.x=void 0===a?0:a;this.y=void 0===c?0:c}n.prototype.normalize=function(){var a=Math.sqrt(p(this,this));this.x/=a;this.y/=a};n.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};n.prototype.sub=function(a){return new n(this.x-a.x,this.y-a.y)};function p(a,c){return a.x*c.x+a.y*c.y}function aa(){var a=r.left+.025*(t+.5),c=r.bottom+.025*(u+.5);this.position=new n(void 0===a?0:a,void 0===c?0:c);this.o=new n;this.j=new n;this.force=new n;this.i=this.pressure=0}
function v(a,c){for(var e=w,g=Math.floor((a.position.x-e.region.left)/e.h),k=Math.floor((a.position.y-e.region.bottom)/e.h),h=g-1;h<=g+1;h++)if(!(0>h||h>=e.m))for(var f=k-1;f<=k+1;f++)if(!(0>f||f>=e.s))for(var q=h+f*e.m,m=0,y=e.l[q].length;m<y;m++){var Q=e.l[q][m],ea=a.position.sub(Q.position);c(Q,ea)}}function x(){var a=new z(1,1);this.h=A;this.m=Math.ceil(a.width/this.h);this.s=Math.ceil(a.height/this.h);this.l=Array(this.m*this.s);this.region=a}
x.prototype.clear=function(){for(var a=0,c=this.l.length;a<c;a++)this.l[a]=[]};x.prototype.add=function(a){for(var c=0,e=a.length;c<e;c++){var g=a[c];this.l[Math.floor((g.position.x-this.region.left)/this.h)+Math.floor((g.position.y-this.region.bottom)/this.h)*this.m].push(a[c])}};function z(a,c){this.width=a;this.height=c;this.left=0;this.right=0+a;this.bottom=0;this.top=0+c}var B=new Stats;B.showPanel(0);document.body.appendChild(B.dom);
for(var A=.025*1.5,C=new function(){var a=A;this.h=a;this.alpha=4/(Math.PI*Math.pow(a,8))},D=new n(0,-9.8),w=new x,E=6*w.h,ba=E*E,F=[],r=new z(.5,.8),ca=Math.round(r.width/.025),da=Math.round(r.height/.025),t=0;t<ca;t++)for(var u=0;u<da;u++)F.push(new aa);b.width=128;b.height=128;var G=Math.min(window.innerWidth,window.innerHeight),H=Math.max(window.innerWidth,window.innerHeight),I=(H-G)/2/G,J,K=0;window.innerWidth>window.innerHeight?(J=0,K=I):(J=I,K=0);
window.addEventListener("resize",function(){G=Math.min(window.innerWidth,window.innerHeight);H=Math.max(window.innerWidth,window.innerHeight);I=(H-G)/2/G;J;K=0;window.innerWidth>window.innerHeight?(J=0,K=I):(J=I,K=0)});var L=0,M=0,N=!1;b.addEventListener("mousedown",function(a){a.preventDefault();O(a)});b.addEventListener("mousemove",function(a){a.preventDefault();P(a)});b.addEventListener("mouseup",function(a){a.preventDefault();N=!1});
b.addEventListener("touchstart",function(a){a.preventDefault();O(a.changedTouches[0])});b.addEventListener("touchmove",function(a){a.preventDefault();P(a.changedTouches[0])});b.addEventListener("touchend",function(a){a.preventDefault();N=!1});function O(a){L=a.pageX/G-K;M=1-a.pageY/G+J;N=!0}function P(a){L=a.pageX/G-K;M=1-a.pageY/G+J}
function fa(){for(var a={},c=0,e=F.length;c<e;a={i:a.i},c++)a.i=0,v(F[c],function(g){return function(k,h){var f=Math.sqrt(p(h,h));g.i+=.625*(f<C.h?C.alpha*Math.pow(C.h*C.h-f*f,3):0)}}(a)),F[c].i=a.i,F[c].pressure=Math.max(100*(F[c].i-1E3),0)}
function ha(){for(var a={g:0},c=F.length;a.g<c;a={g:a.g},a.g++)F[a.g].force.x=0,F[a.g].force.y=0,v(F[a.g],function(e){return function(g,k){if(F[e.g]!==g){var h=Math.sqrt(p(k,k));var f=Math.sqrt(p(k,k));f<C.h?(f=-6*C.alpha*Math.pow(C.h*C.h-f*f,2),f=new n(f*k.x,f*k.y)):f=new n;var q=-.625*(g.pressure/(g.i*g.i)+F[e.g].pressure/(F[e.g].i*F[e.g].i));F[e.g].force.x+=f.x*q;F[e.g].force.y+=f.y*q;q=h*h+.01*A*A;h=F[e.g].o.sub(g.o);f=5/(g.i*F[e.g].i)*p(k,f)/q;F[e.g].force.x+=f*h.x;F[e.g].force.y+=f*h.y}}}(a)),
F[a.g].force.x+=D.x,F[a.g].force.y+=D.y}var ia=document.getElementById("vs"),ja=document.getElementById("fs"),R=[];function S(a,c){var e=d.createShader(a);d.shaderSource(e,c);d.compileShader(e);if(d.getShaderParameter(e,d.COMPILE_STATUS))return e;console.log(d.getShaderInfoLog(e));d.deleteShader(e)}d.enable(d.BLEND);var ka=S(d.VERTEX_SHADER,ia.innerHTML),la=S(d.FRAGMENT_SHADER,ja.innerHTML),T;var U=d.createProgram();d.attachShader(U,ka);d.attachShader(U,la);d.linkProgram(U);
d.getProgramParameter(U,d.LINK_STATUS)?T=U:(console.log(d.getProgramInfoLog(shader)),d.deleteProgram(U),T=void 0);var V=T,W=new Float32Array(2*F.length);d.useProgram(V);var X=d.createTexture();d.bindTexture(d.TEXTURE_2D,X);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);
var Y=d.getAttribLocation(V,"position"),Z=d.getAttribLocation(V,"a_texCoord");R[0]=d.getUniformLocation(V,"u_image");d.uniform1i(R[0],0);d.uniform1f(R[1],-1);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,l);d.blendFuncSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE);var ma=d.createVertexArray(),na=d.createBuffer(),oa=d.STATIC_DRAW;d.bindVertexArray(ma);d.bindBuffer(d.ARRAY_BUFFER,na);d.enableVertexAttribArray(Y);d.enableVertexAttribArray(Z);
d.vertexAttribPointer(Z,2,d.FLOAT,!1,0,0);d.vertexAttribPointer(Y,2,d.FLOAT,!1,0,0);d.bufferData(d.ARRAY_BUFFER,W,oa);d.bindVertexArray(null);d.bindVertexArray(ma);d.clearColor(0,0,0,0);d.viewport(0,0,b.width,b.height);var pa=W.length;
function qa(){B.begin();d.clear(d.COLOR_BUFFER_BIT);d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,X);d.uniform1f(R[1],1);d.uniform1i(R[0],0);for(var a=0;a<pa;a+=2)W[a]=F[a/2].position.x,W[a+1]=F[a/2].position.y;d.bufferSubData(d.ARRAY_BUFFER,0,W);d.drawArrays(d.POINTS,0,pa);d.flush();for(a=0;4>a;a++){w.clear();w.add(F);fa();ha();for(var c=0,e=F.length;c<e;c++){F[c].j.x+=.003125*F[c].force.x;F[c].j.y+=.003125*F[c].force.y;F[c].position.x+=.003125*F[c].j.x;F[c].position.y+=.003125*F[c].j.y;if(.025>
F[c].position.y||.975<F[c].position.y)F[c].j.y=-F[c].j.y;if(.025>F[c].position.x||.975<F[c].position.x)F[c].j.x=-F[c].j.x;F[c].position.x=Math.min(.975,Math.max(F[c].position.x,.025));F[c].position.y=Math.min(.975,Math.max(F[c].position.y,.025));F[c].o.x=F[c].j.x+.0015625*F[c].force.x;F[c].o.y=F[c].j.y+.0015625*F[c].force.y}}if(N)for(a=Math.floor((L-w.region.left)/w.h),c=Math.floor((M-w.region.bottom)/w.h),e=a-6;e<=a+6;e++)if(!(0>e||e>=w.m))for(var g=c-6;g<=c+6;g++)if(!(0>g||g>=w.s))for(var k=e+g*
w.m,h=0,f=w.l[k].length;h<f;h++){var q=w.l[k][h],m=L-q.position.x,y=M-q.position.y;m*m+y*y>ba||(m=new n(m,y),m.x*=2,m.y*=2,q.j.add(m))}B.end();requestAnimationFrame(qa)}qa();
